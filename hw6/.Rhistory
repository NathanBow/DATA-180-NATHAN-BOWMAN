library(tidyverse)
install.packages("tidyverse")
install.packages("tidyverse")
Mammals_Milk<-read.csv("Milk_Composition.csv",header=T,row.names=1)
head(Mammals_Milk)
install.packages("tidyverse")
library(tidyverse)
#library(tidyverse)
install.packages("cli")
Mammals_Milk<-read.csv("Milk_Composition.csv",header=T,row.names=1)
head(Mammals_Milk)
install.packages("cli")
library(tidyverse)
#install.packages("cli")
Mammals_Milk<-read.csv("Milk_Composition.csv",header=T,row.names=1)
head(Mammals_Milk)
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
library(tidyverse)
#install.packages("cli")
Mammals_Milk<-read.csv("Milk_Composition.csv",header=T,row.names=1)
head(Mammals_Milk)
summary(Mammals_Milk)
Mammals_Milk_Std<-round(scale(Mammals_Milk),2)
head(Mammals_Milk_Std)
col_names <- colnames(Mammals_Milk)
colnames(Mammals_Milk_Std) <- col_names
Mammals_Milk_Std <- as.data.frame(Mammals_Milk_Std)
milkclust <- hclust(dist(Mammals_Milk_Std))
plot(milkclust, hang = -1, main = "Mammals Clustered by Standard Milk Composition \n Euclidean Metric, Complete Linkage", sub = "", xlab = "Mammals", cex.lab = 1.25, lwd = 3, frame.plot = TRUE)
set.seed(125)
MMilk_km_3 <- kmeans(Mammals_Milk_Std, centers = 3, nstart = 100)
MMilk_km_4 <- kmeans(Mammals_Milk_Std, centers = 4, nstart = 100)
Mammals_Milk_Std$km_3 <- MMilk_km_3$cluster
Mammals_Milk_Std$km_4 <- MMilk_km_4$cluster
sort_km_3 <- arrange(Mammals_Milk_Std, km_3)
library(tidyverse)
library(dplyr)
#install.packages("cli")
Mammals_Milk<-read.csv("Milk_Composition.csv",header=T,row.names=1)
head(Mammals_Milk)
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
library(tidyverse)
library(dplyr)
#install.packages("cli")
Mammals_Milk<-read.csv("Milk_Composition.csv",header=T,row.names=1)
head(Mammals_Milk)
summary(Mammals_Milk)
Mammals_Milk_Std<-round(scale(Mammals_Milk),2)
head(Mammals_Milk_Std)
col_names <- colnames(Mammals_Milk)
colnames(Mammals_Milk_Std) <- col_names
Mammals_Milk_Std <- as.data.frame(Mammals_Milk_Std)
milkclust <- hclust(dist(Mammals_Milk_Std))
plot(milkclust, hang = -1, main = "Mammals Clustered by Standard Milk Composition \n Euclidean Metric, Complete Linkage", sub = "", xlab = "Mammals", cex.lab = 1.25, lwd = 3, frame.plot = TRUE)
set.seed(125)
MMilk_km_3 <- kmeans(Mammals_Milk_Std, centers = 3, nstart = 100)
MMilk_km_4 <- kmeans(Mammals_Milk_Std, centers = 4, nstart = 100)
Mammals_Milk_Std$km_3 <- MMilk_km_3$cluster
Mammals_Milk_Std$km_4 <- MMilk_km_4$cluster
sort_km_3 <- arrange(Mammals_Milk_Std, km_3)
sort_km_4 <- arrange(Mammals_Milk_Std, km_4)
print(sort_km_3)
print(sort_km_4)
MMilk_Agg_K3 <- Mammals_Milk_Std %>% group_by(km_3) %>% summarize(Count = n(), Mean_Water = round(mean(Water),2), Mean_Protein = round(mean(Protein),2), Mean_Fat = round(mean(Fat),2), Mean_Lactose = round(mean(Lactose),2), Mean_Ash = round(mean(Ash),2))
print(MMilk_Agg_K3)
MMilk_Agg_K4 <- Mammals_Milk_Std %>% group_by(km_4) %>% summarize(Count = n(), Mean_Water = round(mean(Water), 2), Mean_Protein = round(mean(Protein), 2), Mean_Fat = round(mean(Fat), 2), Mean_Lactose = round(mean(Lactose), 2), Mean_Ash = round(mean(Ash), 2))
print(MMilk_Agg_K4)
wgss_values <- numeric(8)
for (k in 1:8)
{kmeans_result <- kmeans(Mammals_Milk_Std, centers = k, nstart = 50)
wgss_values[k] <- kmeans_result$tot.withinss}
plot(1:8, wgss_values, type = "b", xlab = "Number of Clusters", ylab = "WGSS", main = "WGSS by Number of Clusters")
#The elbow plot suggests two clusters. WGSS is diminishing after two clusters. The dendrogram, however, gave the impression that four clusters is best, as the vertical distance is longest around height four.
install.packages("tidyverse")
install.packages("cli")
install.packages("cli")
install.packages("tidyverse")
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
library(tidyverse)
Mammals_Milk<-read.csv("Milk_Composition.csv",header=T,row.names=1)
head(Mammals_Milk)
summary_mammal_milk <- summary(Mammals_Milk)
summary_mammal_milk
Mammals_Milk_Std<-round(scale(Mammals_Milk),2)
head(Mammals_Milk_Std)
hclust_result <- hclust(dist(Mammals_Milk_Std), method = "complete")
plot(hclust_result, main = "Mammals Clustered by Std. Milk Composition \n Euclidean Metric, Complete Linkage",
sub = "", xlab = "Mammals", cex.lab = 1.25, hang = -1, frame.plot = TRUE, labels = rownames(Mammals_Milk_Std), lwd = 3)
set.seed(125)
# K-means clustering for k=3
MMilk_km_3 <- kmeans(Mammals_Milk_Std, centers = 3, nstart = 100)
Mammals_Milk$km_3 <- MMilk_km_3$cluster
# K-means clustering for k=4
MMilk_km_4 <- kmeans(Mammals_Milk_Std, centers = 4, nstart = 100)
Mammals_Milk$km_4 <- MMilk_km_4$cluster
sorted_table_km3 <- arrange(Mammals_Milk, km_3)
print(sorted_table_km3)
sorted_table_km4 <- arrange(Mammals_Milk, km_4)
print(sorted_table_km4)
MMilk_Agg_K3 <- Mammals_Milk %>%
group_by(km_3) %>%
summarize(Count = n(),
Mean_Water = round(mean(Water), 2),
Mean_Protein = round(mean(Protein), 2),
Mean_Fat = round(mean(Fat), 2),
Mean_Lactose = round(mean(Lactose), 2),
Mean_Ash = round(mean(Ash), 2))
MMilk_Agg_K4 <- Mammals_Milk %>%
group_by(km_4) %>%
summarize(Count = n(),
Mean_Water = round(mean(Water), 2),
Mean_Protein = round(mean(Protein), 2),
Mean_Fat = round(mean(Fat), 2),
Mean_Lactose = round(mean(Lactose), 2),
Mean_Ash = round(mean(Ash), 2))
print(MMilk_Agg_K3)
print(MMilk_Agg_K4)
library(ggplot2)
library(cowplot)
#require(cowplot)
graph1 <- ggplot(Mammals_Milk, aes(factor(km_3), Water)) + geom_boxplot() +
labs(title = "Distribution of Water by Cluster Membership")
graph2 <- ggplot(Mammals_Milk, aes(factor(km_3), Protein)) + geom_boxplot() +
labs(title = "Distribution of Protein by Cluster Membership")
graph3 <- ggplot(Mammals_Milk, aes(factor(km_3), Fat)) + geom_boxplot() +
labs(title = "Distribution of Fat by Cluster Membership")
graph4 <- ggplot(Mammals_Milk, aes(factor(km_3), Lactose)) + geom_boxplot() +
labs(title = "Distribution of Lactose by Cluster Membership")
graph5 <- ggplot(Mammals_Milk, aes(factor(km_3), Ash)) + geom_boxplot() +
labs(title = "Distribution of Ash by Cluster Membership")
plot_grid(graph1, graph2, graph3, graph4, graph5, labels = "AUTO")
set.seed(125)
wgss_values <- c()
for (k in 1:8) {
km <- kmeans(Mammals_Milk_Std, centers = k, nstart = 50)
wgss_values <- c(wgss_values, km$tot.withinss)
}
plot(1:8, wgss_values, type = "b", pch = 19, frame = FALSE,
xlab = "Number of Clusters (K)", ylab = "Within-Group Sum of Squares (WGSS)",
main = "WGSS by Number of Clusters")
#The elbow plot suggests 4 clusters. Compared to the dendrogram in Question 2, the elbow plot can give an indication of the optimal number of clusters. When the elbow method suggests a specific number of clusters that align with the number of clusters observed or shown in the dendrogram, it reinforces the optimal choice. Also, dendrogram in question 2, there is an option for larger group to be classified into sub-group by moving the horizontal line. On the other hand for the elbow plot, it shows the optimal number of clusters which matches with the number of clusters observed in the dendrogram.
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
library(tidyverse)
Mammals_Milk<-read.csv("/Users/anishachoudhury/Desktop/DATA 180 Anisha/DATA-180-Anisha/hw6/Milk_Composition.csv",header=T,row.names=1)
library(tidyverse)
#Mammals_Milk<-read.csv("/Users/anishachoudhury/Desktop/DATA 180 Anisha/DATA-180-Anisha/hw6/Milk_Composition.csv",header=T,row.names=1)
Mammals_Milk<-read.csv("C:/Users/rodge/OneDrive/Desktop\DATA_180 Repositories/Choudhury_Anisha/DATA-180-Anisha/hw6/Milk_Composition.csv",header=T,row.names=1)
library(tidyverse)
#Mammals_Milk<-read.csv("/Users/anishachoudhury/Desktop/DATA 180 Anisha/DATA-180-Anisha/hw6/Milk_Composition.csv",header=T,row.names=1)
Mammals_Milk<-read.csv("C:/Users/rodge/OneDrive/Desktop\DATA_180 Repositories/Choudhury_Anisha/DATA-180-Anisha/hw6/Milk_Composition.csv",header=T,row.names=1)
library(tidyverse)
#Mammals_Milk<-read.csv("/Users/anishachoudhury/Desktop/DATA 180 #Anisha/DATA-180-Anisha/hw6/Milk_Composition.csv",header=T,row.names=1)
Mammals_Milk<-read.csv("C:/Users/rodge/OneDrive/Desktop\DATA_180 Repositories/Choudhury_Anisha/DATA-180-Anisha/hw6/Milk_Composition.csv",header=T,row.names=1)
library(tidyverse)
#Mammals_Milk<-read.csv("/Users/anishachoudhury/Desktop/DATA 180 #Anisha/DATA-180-Anisha/hw6/Milk_Composition.csv",header=T,row.names=1)
Mammals_Milk<-read.csv("C:/Users/rodge/OneDrive/Desktop/DATA_180 Repositories/Choudhury_Anisha/DATA-180-Anisha/hw6/Milk_Composition.csv",header=T,row.names=1)
head(Mammals_Milk)
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
library(tidyverse)
#Mammals_Milk<-read.csv("/Users/anishachoudhury/Desktop/DATA 180 #Anisha/DATA-180-Anisha/hw6/Milk_Composition.csv",header=T,row.names=1)
Mammals_Milk<-read.csv("C:/Users/rodge/OneDrive/Desktop/DATA_180 Repositories/Choudhury_Anisha/DATA-180-Anisha/hw6/Milk_Composition.csv",header=T,row.names=1)
head(Mammals_Milk)
Mammals_Milk %>% summary()
Mammals_Milk_Std<-round(scale(Mammals_Milk),2)
head(Mammals_Milk_Std)
Mammals_Milk_Hc <- hclust(dist(Mammals_Milk_Std))
plot(Mammals_Milk_Hc,main="Mammals Clustered by Std. Milk Composition \n Euclidean Metric, Complete Linkage",cex=.75,xlab="Mammals Milk",lwd=3,cex.lab=1.25,hang=-1,sub="",frame.plot=T)
set.seed(125)
MMilk_km_3 <- kmeans(Mammals_Milk_Std, centers=3,nstart=100)
MMilk_km_4 <- kmeans(Mammals_Milk_Std, centers=4,nstart=100)
MMilk_km_3$km_3 <- MMilk_km_3$cluster
MMilk_km_4$km_4 <- MMilk_km_4$cluster
df_km_3 <- data.frame(Mammals_Milk_Std, km_3 = MMilk_km_3$km_3, km_4 = MMilk_km_4$km_4)
df_km_4 <- data.frame(Mammals_Milk_Std, km_3 = MMilk_km_3$km_3, km_4 = MMilk_km_4$km_4)
df_km_3 %>% arrange(km_3)
df_km_4 %>% arrange(km_4)
MMilk_Agg_K3 <- df_km_3 %>% group_by(km_3) %>% summarize(Count=n(),Mean_Protein = mean(Protein), Mean_Water = mean(Water),Mean_Fat = mean(Fat), Mean_Lactose = mean(Lactose),Mean_Ash = mean(Ash))
MMilk_Agg_K4 <- df_km_4 %>% group_by(km_4) %>% summarize(Count=n(),Mean_Protein = mean(Protein), Mean_Water = mean(Water),Mean_Fat = mean(Fat), Mean_Lactose = mean(Lactose),Mean_Ash = mean(Ash))
MMilk_Agg_K3 <- round(MMilk_Agg_K3, 2)
MMilk_Agg_K4 <- round(MMilk_Agg_K4, 2)
MMilk_Agg_K3
MMilk_Agg_K4
#install.packages("cowplot")
require(cowplot)
graph1 <-ggplot(df_km_3, aes(x = km_3, y =Protein , group = km_3)) + geom_boxplot() + labs(title = "Distribution of Protein")
graph2 <- ggplot(df_km_3, aes(x = km_3, y =Water , group = km_3)) + geom_boxplot() + labs(title = "Distribution of Protein")
graph3 <- ggplot(df_km_3, aes(x = km_3, y =Fat , group = km_3)) + geom_boxplot() + labs(title = "Distribution of Protein")
graph4 <- ggplot(df_km_3, aes(x = km_3, y =Lactose , group = km_3)) + geom_boxplot() + labs(title = "Distribution of Protein")
graph5 <- ggplot(df_km_3, aes(x = km_3, y =Ash , group = km_3)) + geom_boxplot() + labs(title = "Distribution of Protein")
plot_grid(graph1, graph2, graph3, graph4, graph5, labels = "AUTO")
WGSS <- rep(0,8)
for (i in 1:8) { WGSS[i]<- kmeans(Mammals_Milk_Std, centers=i, nstart=50) $tot.withinss}
plot(c(1:8), WGSS, type ="b", pch=16, cex=1.3, ylim=c(0,100), xlab="Number of groups", ylab="WGSS")
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
library(tidyverse)
Mammals_Milk<-read.csv("Milk_Composition.csv",header=T,row.names=1)
head(Mammals_Milk)
Mammals_Milk %>% summary()
Mammals_Milk_Std<-round(scale(Mammals_Milk),2)
head(Mammals_Milk_Std)
Mammals_Milk_Hc<-hclust(dist(Mammals_Milk_Std))
plot(Mammals_Milk_Hc,lwd=3,sub="",hang=-1,xlab="Mammals",cex.lab=1.25,
main="Mammals Clustered by Std. Milk Composition \n Euclidean Metric, Complete Linkage",
frame.plot=T)
set.seed(125)
MMilk_km_3<-kmeans(Mammals_Milk_Std,centers=3,nstart=100)
MMilk_km_4<-kmeans(Mammals_Milk_Std,centers=4,nstart=100)
Mammals_Milk<-data.frame(Mammals_Milk,km_3=MMilk_km_3$cluster,km_4=MMilk_km_4$cluster)
Mammals_Milk %>% arrange(km_3)
Mammals_Milk %>% arrange(km_4)
MMilk_Agg_K3<-Mammals_Milk %>%
group_by(km_3) %>%
summarize(Count=n(),Mean_Water=mean(Water),Mean_Protein=mean(Protein), Mean_Fat=mean(Fat),Mean_Lactose=mean(Lactose),Mean_Ash=mean(Ash)) %>%
round(2)
MMilk_Agg_K3
MMilk_Agg_K4<-Mammals_Milk %>%
group_by(km_4) %>%
summarize(Count=n(),Mean_Water=mean(Water),Mean_Protein=mean(Protein),
Mean_Fat=mean(Fat),Mean_Lactose=mean(Lactose),Mean_Ash=mean(Ash)) %>%
round(2)
MMilk_Agg_K4
wgss<-rep(0,8)
for(i in 1:8){
wgss[i]<-kmeans(Mammals_Milk_Std,centers=i,nstart=50)$tot.withinss
}
ggplot(as.data.frame(wgss), aes(x=1:8,y=wgss)) + geom_point(size=2) + geom_line(linetype = "dashed")
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
library(tidyverse)
Mammals_Milk<-read.csv("Milk_Composition.csv",header=T,row.names=1)
head(Mammals_Milk)
summary(Mammals_Milk)
Mammals_Milk_Std<-round(scale(Mammals_Milk),2)
head(Mammals_Milk_Std)
cluster_animals <- hclust(dist(Mammals_Milk_Std), method = "complete")
cluster_animals
plot(cluster_animals, lwd = 3, main = "Mamals Clustered by Std. Milk Composition \n Euclidean Metric, Complete Linkage", xlabs = "Mammals", cex.lab = 1.25, hang = -1, frame.plot = TRUE)
set.seed(125)
MMilk_km_3 <- kmeans(Mammals_Milk_Std, centers = 3, nstart = 100)
new_MammalsMilk3 <- Mammals_Milk %>% mutate(km_3 = MMilk_km_3$cluster) %>% arrange(km_3)
new_MammalsMilk3
MMilk_km_4 <- kmeans(Mammals_Milk_Std, centers = 4, nstart = 100)
new_MammalsMilk4 <- Mammals_Milk %>% mutate(km_4 = MMilk_km_4$cluster) %>% arrange(km_4)
new_MammalsMilk4
MMilk_Agg_K3 <- new_MammalsMilk3 %>% group_by(km_3) %>% summarise(Count = n(), Mean_Water = mean(Water), Mean_Protein = mean(Protein), Mean_Fat = mean(Fat), Mean_Lactose = mean(Lactose), Mean_Ash = mean(Ash))
round(MMilk_Agg_K3, 2)
MMilk_Agg_K4 <- new_MammalsMilk4 %>% group_by(km_4) %>% summarise(count = n(), Mean_Water = mean(Water), Mean_Protein = mean(Protein), Mean_Fat = mean(Fat), Mean_Lactose = mean(Lactose), Mean_Ash = mean(Ash))
round(MMilk_Agg_K4, 2)
wgss <- rep(1,8)
for (i in 1:8) {wgss[i] <- kmeans(Mammals_Milk_Std, centers = i, nstart = 50)$tot.withinss}
plot(c(1:8), wgss, type = "b", pch = 16, cex = 1.3, ylim = c(0,100), xlab = "Number of Groups", ylab = "WGSS")
# The elbow plot suggests 7 clusters.
# The dendogram in Question 2 suggests a lot more clusters than the elbow plot.
install.packages("tidyverse")
install.packages("cli")
install.packages("cli")
install.packages("tidyverse")
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
library(tidyverse)
Mammals_Milk<-read.csv("/Users/tommyeaton/Desktop/Data 180 Tommy Eaton/Data-180-Tommy-Eaton/hw6/Milk_Composition.csv",header=T,row.names=1)
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
library(tidyverse)
# Mammals_Milk<-read.csv("/Users/tommyeaton/Desktop/Data 180 Tommy Eaton/Data-180-Tommy-Eaton/hw6/Milk_Composition.csv",header=T,row.names=1)
Mammals_Milk<-read.csv("C:/Users/rodge/OneDrive/Desktop/DATA_180 Repositories/Eaton_Tommy/Data-180-Tommy-Eaton/hw6/Milk_Composition.csv",header=T,row.names=1)
head(Mammals_Milk)
summary(Mammals_Milk)
Mammals_Milk_Std<-round(scale(Mammals_Milk),2)
head(Mammals_Milk_Std)
Mammals_Milk_Std <- round(scale(Mammals_Milk), 2)
hc <- hclust(dist(Mammals_Milk_Std, method = "euclidean"), method = "complete")
plot(hc, hang = -1, main = "Mammals Clustered by Std. Milk Composition \n Euclidean Metric, Complete Linkage",
sub = "", xlab = "Mammals", cex.lab = 1.25, frame.plot = TRUE, lwd = 3)
set.seed(125)
MMilk_km_3 <- kmeans(Mammals_Milk_Std, centers = 3, nstart = 100)
MMilk_km_4 <- kmeans(Mammals_Milk_Std, centers = 4, nstart = 100)
Mammals_Milk_Clustered <- Mammals_Milk
Mammals_Milk_Clustered$km_3 <- MMilk_km_3$cluster
Mammals_Milk_Clustered$km_4 <- MMilk_km_4$cluster
sorted_km_3 <- arrange(Mammals_Milk_Clustered, km_3)
sorted_km_4 <- arrange(Mammals_Milk_Clustered, km_4)
print("K = 3 Cluster Sorting:")
head(sorted_km_3)
print("K = 4 Cluster Sorting:")
head(sorted_km_4)
MMilk_Agg_K3 <- sorted_km_3 %>%
group_by(km_3) %>%
summarize(
Count = n(),
Mean_Water = round(mean(Water), 2),
Mean_Protein = round(mean(Protein), 2),
Mean_Fat = round(mean(Fat), 2),
Mean_Lactose = round(mean(Lactose), 2),
Mean_Ash = round(mean(Ash), 2)
)
MMilk_Agg_K4 <- sorted_km_4 %>%
group_by(km_4) %>%
summarize(
Count = n(),
Mean_Water = round(mean(Water), 2),
Mean_Protein = round(mean(Protein), 2),
Mean_Fat = round(mean(Fat), 2),
Mean_Lactose = round(mean(Lactose), 2),
Mean_Ash = round(mean(Ash), 2)
)
MMilk_Agg_K3
MMilk_Agg_K4
wgss_values <- numeric(0)
for (k in 1:8) {
set.seed(125)
km <- kmeans(Mammals_Milk_Std, centers = k, nstart = 50)
wgss <- sum(km$withinss)
wgss_values <- c(wgss_values, wgss)
}
plot(1:8, wgss_values, type = "b", pch = 19, frame.plot = TRUE,
xlab = "Number of Clusters (K)", ylab = "WGSS",
main = "WGSS vs. Number of Clusters")
elbow_point <- which.min(wgss_values)
abline(v = elbow_point, col = "red", lty = 2)
legend("topright", legend = paste("Elbow Point (K =", elbow_point, ")"), col = "red", lty = 2)
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
library(tidyverse)
Mammals_Milk<-read.csv("Milk_Composition.csv",header=T,row.names=1)
head(Mammals_Milk)
summary(Mammals_Milk)
Mammals_Milk_Std<-round(scale(Mammals_Milk),2)
head(Mammals_Milk_Std)
EucAnimPlot = hclust(dist((Mammals_Milk_Std)))
plot(EucAnimPlot, lwd = 3, frame.plot = T, cex.lab = 1.25, hang = -1, main = "Mammals Clustered by Std. Milk Composition \n Euclidean Metric, Complete Linkage", xlab = "Mammals", ylab = "", sub = "")
set.seed(125)
MMilk_km_3 = kmeans(Mammals_Milk_Std, centers = 3, nstart = 100)
MMilk_km_4 = kmeans(Mammals_Milk, centers = 4, nstart = 100)
Mammals_Milk = data.frame(Mammals_Milk, km_3=MMilk_km_3$cluster, km_4=MMilk_km_4$cluster)
Mammals_Milk %>% arrange(km_3)
Mammals_Milk %>% arrange(km_4)
MMilk_Agg_K3 = Mammals_Milk %>% group_by(km_3) %>% summarize(Count = n(), Mean_Water = mean(Water), Mean_Protein = mean(Protein), Mean_Fat = mean(Fat), Mean_Lactose = mean(Lactose), Mean_Ash = mean(Ash)) %>% round(2)
MMilk_Agg_K3
MMilk_Agg_K4 = Mammals_Milk %>% group_by(km_4) %>% summarize(Count = n(), Mean_Water = mean(Water), Mean_Protein = mean(Protein), Mean_Fat = mean(Fat), Mean_Lactose = mean(Lactose), Mean_Ash = mean(Ash)) %>% round(2)
MMilk_Agg_K4
install.packages("cowplot")
require(cowplot)
graph1 <- ggplot(Mammals_Milk, aes(x = factor(km_3), y = Water)) + geom_boxplot()
graph2 <- ggplot(Mammals_Milk, aes(x = factor(km_3), y = Protein)) + geom_boxplot()
graph3 <- ggplot(Mammals_Milk, aes(x = factor(km_3), y = Fat)) + geom_boxplot()
graph4 <- ggplot(Mammals_Milk, aes(x = factor(km_3), y = Lactose)) + geom_boxplot()
graph5 <- ggplot(Mammals_Milk, aes(x = factor(km_3), y = Ash)) + geom_boxplot()
plot_grid(graph1, graph2, graph3, graph4, graph5, labels = "AUTO")
wgss = rep(0,8)
for(i in 1:8){
wgss[i] = kmeans(Mammals_Milk_Std, centers = i, nstart = 50)$tot.withinss
}
ggplot(as.data.frame(wgss), aes(x = 1:8, y = wgss)) + geom_point(size = 2) + geom_line(linetype = "dashed")
# The elbow plot suggests 4 clusters since the slope is much less at x = 4
# I think this graph lines up with the dendogram from question 2 because if you cut the dendogram at 4, we would break the set into just 3 clusters
install.packages("cowplot")
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
library(tidyverse)
Mammals_Milk<-read.csv("Milk_Composition.csv",header=T,row.names=1)
head(Mammals_Milk)
Mammals_Milk_Std<-round(scale(Mammals_Milk),2)
head(Mammals_Milk_Std)
set.seed(125)
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
library(tidyverse)
Mammals_Milk<-read.csv("Milk_Composition.csv",header=T,row.names=1)
head(Mammals_Milk)
summary(Mammals_Milk)
Mammals_Milk_Std<-round(scale(Mammals_Milk),2)
head(Mammals_Milk_Std)
dist_animals = dist(Mammals_Milk_Std, method = "euclidean")
h_animals = hclust(dist_animals, method="complete")
plot(h_animals, lwd=3, cex.lab=1.25, main="Mammals Clustered by Std. Milk Composition \n Euclidean Metric, Complete Linkage", hang=-1, xlab="Mammals", sub="", frame.plot=T)
set.seed(125)
MMilk_km_3 = kmeans(Mammals_Milk_Std, centers=3, nstart=100)
MMilk_km_4 = kmeans(Mammals_Milk_Std, centers=4, nstart=100)
Mammals_Milk = mutate(as.data.frame(Mammals_Milk), km_3=MMilk_km_3$cluster)
Mammals_Milk = mutate(as.data.frame(Mammals_Milk), km_4=MMilk_km_4$cluster)
MMtable_k3=arrange(Mammals_Milk, km_3)
MMtable_k4=arrange(Mammals_Milk, km_4)
print(MMtable_k3)
print(MMtable_k4)
MMilk_Agg_K3 = round(summarize(group_by(MMtable_k3, km_3), Count=n(),
Mean_Water=mean(Water),
Mean_Protein=mean(Protein),
Mean_Fat=mean(Fat),
Mean_Lactose=mean(Lactose),
Mean_Ash=mean(Ash)), 2)
MMilk_Agg_K4 = round(summarize(group_by(MMtable_k4, km_4), Count=n(),
Mean_Water=mean(Water),
Mean_Protein=mean(Protein),
Mean_Fat=mean(Fat),
Mean_Lactose=mean(Lactose),
Mean_Ash=mean(Ash)), 2)
MMilk_Agg_K3
MMilk_Agg_K4
require(cowplot)
graph1 <- ggplot(MMtable_k3)+geom_boxplot(aes(Water))
graph2 <- ggplot(MMtable_k3)+geom_boxplot(aes(Protein))
graph3 <- ggplot(MMtable_k3)+geom_boxplot(aes(Fat))
graph4 <- ggplot(MMtable_k3)+geom_boxplot(aes(Lactose))
graph5 <- ggplot(MMtable_k3)+geom_boxplot(aes(Ash))
plot_grid(graph1, graph2, graph3, graph4, graph5, labels = "AUTO")
WGSSs = list()
for (i in 1:8){
WGSSs=append(WGSSs, kmeans(Mammals_Milk_Std, centers=i, nstart=50)$tot.withinss)
}
plot(c(1:8),WGSSs,type="b",pch=16,cex=1.3,ylim=c(0,120), xlab="Number of Groups",ylab="WGSS")
#The elbow plot suggests that 2, 3, or 4 clusters may be good options.
#However, the wgss for k=3 isn't as small as I would have expected; the slope between k=2&3 is almost as low as between k=3&4; the curve isn't as smooth and rounded as normal.
#The dendrogram seems to reflect this.  k=2&4 appear to be nice numbers of clusters, but k=3 clusters leaves one huge cluster and two little ones.
#It's very subjective, but it seems that both hclustering and kmeans point to the idea that either 2 or 4 clusters are optimal and k=3 is ok but not quite as good/efficient.
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
library(tidyverse)
Mammals_Milk<-read.csv("Milk_Composition.csv",header=T,row.names=1)
head(Mammals_Milk)
summary(Mammals_Milk)
Mammals_Milk_Std<-round(scale(Mammals_Milk),2)
head(Mammals_Milk_Std)
dist_animals = dist(Mammals_Milk_Std, method = "euclidean")
h_animals = hclust(dist_animals, method="complete")
plot(h_animals, lwd=3, cex.lab=1.25, main="Mammals Clustered by Std. Milk Composition \n Euclidean Metric, Complete Linkage", hang=-1, xlab="Mammals", sub="", frame.plot=T)
set.seed(125)
MMilk_km_3 = kmeans(Mammals_Milk_Std, centers=3, nstart=100)
MMilk_km_4 = kmeans(Mammals_Milk_Std, centers=4, nstart=100)
Mammals_Milk = mutate(as.data.frame(Mammals_Milk), km_3=MMilk_km_3$cluster)
Mammals_Milk = mutate(as.data.frame(Mammals_Milk), km_4=MMilk_km_4$cluster)
MMtable_k3=arrange(Mammals_Milk, km_3)
MMtable_k4=arrange(Mammals_Milk, km_4)
print(MMtable_k3)
print(MMtable_k4)
MMilk_Agg_K3 = round(summarize(group_by(MMtable_k3, km_3), Count=n(),
Mean_Water=mean(Water),
Mean_Protein=mean(Protein),
Mean_Fat=mean(Fat),
Mean_Lactose=mean(Lactose),
Mean_Ash=mean(Ash)), 2)
MMilk_Agg_K4 = round(summarize(group_by(MMtable_k4, km_4), Count=n(),
Mean_Water=mean(Water),
Mean_Protein=mean(Protein),
Mean_Fat=mean(Fat),
Mean_Lactose=mean(Lactose),
Mean_Ash=mean(Ash)), 2)
MMilk_Agg_K3
MMilk_Agg_K4
require(cowplot)
graph1 <- ggplot(MMtable_k3)+geom_boxplot(aes(Water))
graph2 <- ggplot(MMtable_k3)+geom_boxplot(aes(Protein))
graph3 <- ggplot(MMtable_k3)+geom_boxplot(aes(Fat))
graph4 <- ggplot(MMtable_k3)+geom_boxplot(aes(Lactose))
graph5 <- ggplot(MMtable_k3)+geom_boxplot(aes(Ash))
plot_grid(graph1, graph2, graph3, graph4, graph5, labels = "AUTO")
WGSSs = list()
for (i in 1:8){
WGSSs=append(WGSSs, kmeans(Mammals_Milk_Std, centers=i, nstart=50)$tot.withinss)
}
plot(c(1:8),WGSSs,type="b",pch=16,cex=1.3,ylim=c(0,120), xlab="Number of Groups",ylab="WGSS")
#The elbow plot suggests that 2, 3, or 4 clusters may be good options.
#However, the wgss for k=3 isn't as small as I would have expected; the slope between k=2&3 is almost as low as between k=3&4; the curve isn't as smooth and rounded as normal.
#The dendrogram seems to reflect this.  k=2&4 appear to be nice numbers of clusters, but k=3 clusters leaves one huge cluster and two little ones.
#It's very subjective, but it seems that both hclustering and kmeans point to the idea that either 2 or 4 clusters are optimal and k=3 is ok but not quite as good/efficient.
